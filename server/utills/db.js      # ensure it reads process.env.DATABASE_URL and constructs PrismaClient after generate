require('dotenv').config();
const { PrismaClient } = require('@prisma/client');

let prisma;

async function initializePrisma() {
    if (!prisma) {
        try {
            await prisma.$connect();
        } catch (error) {
            console.error('PrismaClient initialization error:', error);
            throw error;
        }
    }
}

const DATABASE_URL = process.env.DATABASE_URL;

if (!DATABASE_URL) {
    throw new Error('DATABASE_URL is not defined in .env file');
}

initializePrisma();

module.exports = { prisma };